<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcript Viewer - Phase 3</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom:1px solid #ccc;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .active {
            background-color: #d4edda;
            font-weight: bold;
        }
        .segment-row:hover {
            background-color: #f5f5f5;
            cursor: pointer;
        }
        .selected {
            background-color: #fff3cd;
            font-weight: bold;
        }
        .info-box {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .switch-btn {
            cursor: pointer;
            color: #0066cc;
            text-decoration: underline;
        }
        .switch-btn:hover {
            color: #004499;
        }
    </style>
</head>
<body>
    <h1>Transcript Viewer - Phase 3</h1>
    
    <div class="info-box">
        <p><strong>Total Duration:</strong> {{ data.total_duration }} seconds</p>
        <p><strong>Total Segments:</strong> {{ data.segments|length }}</p>
        <p><strong>Total Groups:</strong> {{ data.groups|length }}</p>
        <p><em>This view supports user intent: click segments to select, click take IDs to switch.</em></p>
    </div>
    
    <h2>Segments</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Text</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Duration</th>
                <th>Word Count</th>
                <th>Selection</th>
            </tr>
        </thead>
        <tbody>
            {% for segment in data.segments %}
            <tr class="segment-row {% if segment.is_selected %}selected{% endif %}" data-segment-id="{{ segment.id }}">
                <td>{{ segment.id }}</td>
                <td>{{ segment.text }}</td>
                <td>{{ "%.3f"|format(segment.start_time) }}s</td>
                <td>{{ "%.3f"|format(segment.end_time) }}s</td>
                <td>{{ "%.3f"|format(segment.duration) }}s</td>
                <td>{{ segment.word_count }}</td>
                <td>{% if segment.is_selected %}[SELECTED]{% else %}{% endif %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <h2>Groups and Takes</h2>
    {% for group in data.groups %}
    <h3>Group: {{ group.id }}</h3>
    <table>
        <thead>
            <tr>
                <th>Take ID</th>
                <th>Segment ID</th>
                <th>Text</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for take in group.takes %}
            <tr class="{% if take.is_active %}active{% endif %}">
                <td>{{ take.id }}</td>
                <td>{{ take.segment_id }}</td>
                <td>{{ take.text }}</td>
                <td>{{ "%.3f"|format(take.start_time) }}s</td>
                <td>{{ "%.3f"|format(take.end_time) }}s</td>
                <td>{% if take.is_active %}Active{% else %}Inactive{% endif %}</td>
                <td>
                    {% if not take.is_active %}
                    <span class="switch-btn" data-take-switch="{{ take.id }}" data-segment-id="{{ take.segment_id }}">Switch to this take</span>
                    {% else %}
                    <em>Currently active</em>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endfor %}
    
    <h2>Debug Information</h2>
    <div class="info-box">
        <p><strong>Phase 3 Features:</strong></p>
        <ul>
            <li>Load example transcript data</li>
            <li>Call transcript_core logic</li>
            <li>Display segments, groups, and takes</li>
            <li>Show active take status</li>
            <li>User can select segments by clicking</li>
            <li>User can switch takes by clicking switch controls</li>
            <li>JavaScript emits intent events to server</li>
        </ul>
        <p><strong>Phase 3 Limitations:</strong></p>
        <ul>
            <li>No editing capabilities</li>
            <li>No drag and drop</li>
            <li>No timeline canvas</li>
            <li>No video/audio playback</li>
            <li>JavaScript only emits intent, no logic</li>
        </ul>
    </div>

    <script src="{{ url_for('static', filename='js/intent.js') }}"></script>
</body>
</html>

